# 6 Schema Design and Management
schema设计必须考虑查询,有些设计对某些查询优化,但是对另外一些操作性能低.

schema设计会随着业务的要求而变化.

..

逻辑设计,物理设计,查询执行.

## Choosing Optimal Data Types
better choices:
- Smaller is usually better:
    faster because use less space, fewer CPU cycles
- Simple is good
    integer比characters好,因为characters比较时更复杂.
    eg. 1.时间用date或datetime而不是string 2.integers存IP而不是string
- Avoid NULL if possible
    尽量不用NULL值,因为更耗空间,索引~索引统计数据~值比较时也需要特殊处理
数字,字符串,时间选择字段很直观,有些情况不那么直观.
有些数据类型有特殊行为.
DATETIME vs TIMESTAMP: TIMESTAMP只用一半空间,还有自动更新特性.
类型别名不影响实际类型.

## Whole Numbers
integer: tinyint~smallint~mediumint~int~bigint 8~16~24~32~64bit
可以设置为unsigned,只能存自然数,容量不变
..
Number类型的计算都是用bigint来计算的(Decimal和Double除外)
int(1)==int(20)

## Real Numbers
decimal还可以用于比bigint还大的数
float和double用的是标准浮点算术
只能存不准确的数据
Float: 4bytes, Double: 8bytes
Decimal需要更大空间,更多计算消耗.所以除非是精确要求的(钱),否则最好不用.
## String Types
每个string字段都有自己的字符集和排序规则
### VARCHAR and CHAR types
..
..
VARCHAR:
长度可变,因此比CHAR存储空间小
长度255则+1byte,长度更多则+更多byte
因为长度会变化,如果过长了,InnoDB会分页
字段变化少,字段最大长度比平均长度大很多,适合使用.
..
CHAR:
存储空间固定.存储时去除末尾的空格,比较时补全空格.
CHAR适用场景: 
 1. MD5 固定长度
 2. 字段经常改变 不易碎片化
 3. Y~N 只需要1byte,varchar需要2bytes
..
..
..
binary 和 varbinary行为类似,但是binary不存储空格,存储\0, 也不去除\0当查询时. 
binary直接比较数字,比字符串的比较要快.

## BLOB and TEXT types
BLOB和TEXT用于存储binary或strings
..
BLOB和TEXT有独立标识,当很大时,会单独存储.
BLOB和TEXT的区别,BLOB存储binary,TEXT存储strings
BLOB和TEXT排序只排序[max_sort_length]之类的数据
..
## Using ENUM instead of a string type
ENUM 1-2bytes,取决于值的数字值大小
..
..
..
..
..
enum连char和varchar比char和varchar连enum慢
## Date and Time Types
最好能存毫秒,Datetime和timestamp都可以存日期+时间.
DATETIME:
精确到毫秒级, YYYYMMDDHHHMMSS格式, 8bytes, 无视时区.可以排序,无歧义.
TIMESTAMP:
精确到毫秒级, 从1970GMT, 4bytes. 依赖时区,需要设置.可以配置插入/更新时更新当前时间戳.
## Bit-PACKED Data Types
BIT: 使用固定空间, BIT(1)1byte, BIT(2)2byte, BIT(3)3byte, BIT(4)4byte, BIT(5)5byte...
### SET
存很多true和false值.
FIND_IN_SET(field, set)
### Bitwise operations on integer columns
